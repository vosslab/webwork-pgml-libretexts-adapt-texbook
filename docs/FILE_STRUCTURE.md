# File structure

## Top-level layout
- `AGENTS.md`: agent workflow rules (content constraints, linting expectations, and environment notes).
- `README.md`: repository overview and editing/validation workflow for the textbook.
- `Textbook/`: the textbook content as LibreTexts-ready HTML, organized by chapter.
- `docs/`: repo conventions and authoring guides (including this file).
- `tools/`: small, single-purpose authoring utilities (Python scripts).
- `tests/`: local verification scripts (HTML lint and Python lint).
- `Insight-HTML/`: extracted source material used as writing input (do not edit as textbook pages).
- `WebWorK-HTML/`: extracted source material used as writing input (do not edit as textbook pages).
- `Links/`: URL lists and extracted link inventories used to drive reference collection.
- `devel/`: developer-only helpers (for example changelog/commit workflows).
- `LICENSE`: license text.
- `pyflakes.txt`: generated pyflakes output (ignored by `.gitignore`).

## Key subtrees
- `Textbook/`
  - `01_Introduction/`: Chapter 1 pages (`1.0-Index.html` and subsections).
  - `02_Problem_Generation_PG/`: Chapter 2 pages (minimal PG scaffolding).
  - `03_PGML_PG_Markup_Language/`: Chapter 3 pages (PGML authoring patterns).
  - `04_Breaking_Down_the_Components/`: Chapter 4 index page.
  - `05_Different_Question_Types/`: Chapter 5 pages (question types plus ADAPT workflow and QA).
  - `06_Advanced_PGML_Techniques/`: Chapter 6 pages (advanced PGML techniques).
  - `07_Testing_and_Debugging/`: Chapter 7 pages (linting, renderer setup, scripting, and QA).
  - `08_Using_AI_Agents_to_Write_WeBWorK/`: Chapter 8 pages (AI-agent workflow content).
  - `90_Appendices/`: appendices (templates, cheat sheet, glossary, troubleshooting).
  - `TEXTBOOK_PAGE_SUMMARIES.md`: one-entry-per-page summaries used for planning and navigation support.
- `docs/`
  - `LIBRETEXTS_HTML_GUIDE.md`: the allowed HTML patterns for LibreTexts import.
  - `MARKDOWN_STYLE.md`: Markdown style rules for repo documentation.
  - `PYTHON_STYLE.md`: Python style rules for repo scripts.
  - `REPO_STYLE.md`: repo structure and naming conventions.
  - `CHANGELOG.md`: dated record of user-facing changes.
  - `CODE_ARCHITECTURE.md`: high-level component map and workflows.
  - `FILE_STRUCTURE.md`: directory map and "where to put things" guidance.
- `tools/`
  - `README.md`: tool catalog with one-line descriptions and usage examples for all tools.
  - `lint_textbook_problems.py`: end-to-end pipeline to extract textbook PG problems and lint them (static + renderer).
  - `pglint.py`: lint PG files via the renderer HTTP API (pyflakes-style output).
  - `webwork_simple_lint.py`: lightweight static lint for `.pg` files (macro coverage, balanced markers).
  - `extract_textbook_pre_blocks.py`: extract `<pre>` blocks from textbook HTML into `.pg` files.
  - `textbook_code_block_validator.py`: scan `<pre>` blocks for unmatched PG/PGML markers.
  - `html_lint_checker.py`: lints `Textbook/` HTML for LibreTexts compatibility.
  - `extract_url_links_from_html_file.py`: extracts `href`/`src` links from an HTML file into a sorted text list.
  - `get_insight.py`: uses Playwright to render pages and save simplified HTML snapshots from URL lists.
  - `xml_formatter.py`: formats XML files using `lxml` (in-place, with a `.bak` backup).
- `tests/`
  - `run_html_lint.sh`: runs `tools/html_lint_checker.py` against `Textbook/`.
  - `run_pyflakes.sh`: runs `pyflakes` against repo Python files and writes `pyflakes.txt`.

## Generated artifacts
- `pyflakes.txt`: generated by `tests/run_pyflakes.sh` and ignored by `.gitignore`.
- `output/textbook_pre_blocks/`: extracted `.pg` files and `lint_report.csv` from
  `tools/lint_textbook_problems.py`; ignored by `.gitignore`.
- `.DS_Store`: macOS metadata files, ignored by `.gitignore`.
- `pw-profile/`: may be created by `tools/get_insight.py` as a Playwright persistent profile directory (default
  `--profile-dir pw-profile`); this path is not ignored by `.gitignore`.

## Documentation map
- Root-level docs
  - `README.md`: what the repo is and how to edit/validate.
  - `AGENTS.md`: agent constraints and environment requirements.
- `docs/`
  - Style and conventions: `MARKDOWN_STYLE.md`, `PYTHON_STYLE.md`, `REPO_STYLE.md`.
  - LibreTexts constraints: `LIBRETEXTS_HTML_GUIDE.md`.
  - Maintenance logs: `CHANGELOG.md`.
  - Repo maps: `CODE_ARCHITECTURE.md`, `FILE_STRUCTURE.md`.

## Where to add new work
- New textbook material: add or edit HTML under `Textbook/<chapter>/` and keep it compatible with
  the [LibreTexts HTML guide](LIBRETEXTS_HTML_GUIDE.md).
- New summaries: update `Textbook/TEXTBOOK_PAGE_SUMMARIES.md` when adding or renaming pages.
- New authoring utilities: add small scripts under `tools/` (prefer single-purpose scripts).
- New checks: add runnable scripts under `tests/` and keep them repo-root aware.
- New documentation: add Markdown under `docs/` using SCREAMING_SNAKE_CASE filenames.
