<p style="background-color: #dbeafe; padding: 6px 10px;"><strong>Preamble</strong></p>
<p>
The Preamble is the environment setup for the problem. It loads the macro files that make PGML
work and unlocks specific interaction patterns the rest of the file assumes exist.
</p>
<p>
Rule of thumb: if something does not render, suspect macros first. Missing dependencies often look
like prompt failures, but the fix is usually in what you loaded, not in the PGML text.
</p>
<p>
Example: you add a matching list and it renders as plain text. The fix is not in the prompt; it is
loading <code>PGchoicemacros.pl</code> so the matching utilities are available.
</p>
<p>
Why this exists: it declares which macro files and features the problem can use.
</p>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 50%;">
		<col style="width: 50%;">
	</colgroup>
	<thead>
		<tr>
			<th>Common edits</th>
			<th>Common failures</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Common edits">
				<ul>
					<li>Add a macro to enable a new interaction.</li>
					<li>Remove a macro that is not used.</li>
				</ul>
			</td>
			<td data-th="Common failures">
				<ul>
					<li>A feature is missing because the macro is not loaded.</li>
					<li>Load order masks a macro or parser option.</li>
				</ul>
			</td>
		</tr>
	</tbody>
</table>

<h2>Macro selection (what to load)</h2>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 18%;">
		<col style="width: 22%;">
		<col style="width: 22%;">
		<col style="width: 20%;">
		<col style="width: 18%;">
	</colgroup>
	<thead>
		<tr>
			<th>Macro</th>
			<th>What it enables</th>
			<th>When you need it</th>
			<th>Common failure</th>
			<th>Canonical example</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Macro">PGstandard.pl</td>
			<td data-th="What it enables">Core PG functions and helpers.</td>
			<td data-th="When you need it">Always (baseline PG utilities).</td>
			<td data-th="Common failure">Undefined basic functions.</td>
			<td data-th="Canonical example">OpenWeBWorK PG samples: most core examples.</td>
		</tr>
		<tr>
			<td data-th="Macro">MathObjects.pl</td>
			<td data-th="What it enables">MathObjects, Context(), and answer checkers.</td>
			<td data-th="When you need it">Any numeric or formula answer.</td>
			<td data-th="Common failure">Context or answer objects are missing.</td>
			<td data-th="Canonical example">OpenWeBWorK PG samples: MathObjects basics.</td>
		</tr>
		<tr>
			<td data-th="Macro">PGML.pl</td>
			<td data-th="What it enables">PGML prompt blocks and inserts.</td>
			<td data-th="When you need it">Any PGML-first prompt.</td>
			<td data-th="Common failure">BEGIN_PGML fails or renders raw text.</td>
			<td data-th="Canonical example">OpenWeBWorK PG samples: PGML intro pages.</td>
		</tr>
		<tr>
			<td data-th="Macro">PGcourse.pl</td>
			<td data-th="What it enables">Course macros and shared helpers.</td>
			<td data-th="When you need it">You rely on course-wide helpers.</td>
			<td data-th="Common failure">Custom helper not found.</td>
			<td data-th="Canonical example">OpenWeBWorK PG samples: course macro usage.</td>
		</tr>
		<tr>
			<td data-th="Macro">PGchoicemacros.pl</td>
			<td data-th="What it enables">Choice utilities and display helpers.</td>
			<td data-th="When you need it">Multiple choice, multiple answer, matching, ordering.</td>
			<td data-th="Common failure">Choice widgets do not render.</td>
			<td data-th="Canonical example">OpenWeBWorK PG samples: choice technique pages.</td>
		</tr>
		<tr>
			<td data-th="Macro">parserMultiAnswer.pl</td>
			<td data-th="What it enables">MultiAnswer coordination across blanks.</td>
			<td data-th="When you need it">Interdependent multi-part answers.</td>
			<td data-th="Common failure">Blanks accept answers independently.</td>
			<td data-th="Canonical example">OpenWeBWorK PG sample: parserMultiAnswer.</td>
		</tr>
	</tbody>
</table>

<p>
For choice-based interactions, rely on <code>PGchoicemacros.pl</code> and mirror the official
technique sample pages in the OpenWeBWorK PG samples so the UI matches the pattern you want.
</p>

<p>
Useful reference samples include parserMultiAnswer and NumericalTolerance in the OpenWeBWorK PG
samples, which show canonical patterns for coordinated blanks and tolerance handling.
</p>

<p>
Some older examples use legacy macros or interaction widgets that still appear online; prefer the
patterns shown in the official PG sample problems when choosing an interaction style.
</p>

<h2>When it breaks</h2>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 28%;">
		<col style="width: 36%;">
		<col style="width: 36%;">
	</colgroup>
	<thead>
		<tr>
			<th>Symptom</th>
			<th>Likely cause</th>
			<th>Fix</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Symptom">Macro not found error</td>
			<td data-th="Likely cause">Missing macro file in <code>loadMacros()</code>.</td>
			<td data-th="Fix">Add the macro and keep load order consistent.</td>
		</tr>
		<tr>
			<td data-th="Symptom">Choice widget renders as plain text</td>
			<td data-th="Likely cause">Choice macro file not loaded.</td>
			<td data-th="Fix">Load <code>PGchoicemacros.pl</code> in the Preamble.</td>
		</tr>
		<tr>
			<td data-th="Symptom">PGML block not recognized</td>
			<td data-th="Likely cause">Missing <code>PGML.pl</code>.</td>
			<td data-th="Fix">Load <code>PGML.pl</code> before the PGML block.</td>
		</tr>
	</tbody>
</table>
