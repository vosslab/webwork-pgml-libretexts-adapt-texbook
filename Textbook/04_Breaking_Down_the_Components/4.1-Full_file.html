<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 18%;">
		<col style="width: 12%;">
		<col style="width: 35%;">
		<col style="width: 35%;">
	</colgroup>
	<thead>
		<tr>
			<th>Section</th>
			<th>Color</th>
			<th>What it controls</th>
			<th>What to check when debugging</th>
		</tr>
	</thead>
	<tbody>
		<tr style="background-color: #dbeafe;">
			<td data-th="Section">Preamble</td>
			<td data-th="Color">Blue</td>
			<td data-th="What it controls">Macros, rendering switches, and global knobs.</td>
			<td data-th="What to check when debugging">Missing macro files, wrong load order, or disabled features.</td>
		</tr>
		<tr style="background-color: #dcfce7;">
			<td data-th="Section">Setup</td>
			<td data-th="Color">Green</td>
			<td data-th="What it controls">Values, constraints, answers, and graders.</td>
			<td data-th="What to check when debugging">Bad ranges, unit mismatches, or tolerance mistakes.</td>
		</tr>
		<tr style="background-color: #ffedd5;">
			<td data-th="Section">Statement</td>
			<td data-th="Color">Orange</td>
			<td data-th="What it controls">PGML prompt text, structure, and blanks.</td>
			<td data-th="What to check when debugging">Blank binding, missing inserts, or formatting breaks.</td>
		</tr>
		<tr style="background-color: #fce7f3;">
			<td data-th="Section">Solution</td>
			<td data-th="Color">Pink</td>
			<td data-th="What it controls">Explanations, trust, and grading alignment.</td>
			<td data-th="What to check when debugging">Mismatch between solution conventions and the checker.</td>
		</tr>
	</tbody>
</table>

<h2>Section anchors (reference map)</h2>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 18%;">
		<col style="width: 22%;">
		<col style="width: 22%;">
		<col style="width: 38%;">
	</colgroup>
	<thead>
		<tr>
			<th>Section</th>
			<th>Starts at</th>
			<th>Ends at</th>
			<th>One-line description</th>
		</tr>
	</thead>
	<tbody>
		<tr style="background-color: #dbeafe;">
			<td data-th="Section">Preamble</td>
			<td data-th="Starts at"># ===== PREAMBLE (blue) =====</td>
			<td data-th="Ends at"># ===== SETUP (green) =====</td>
			<td data-th="One-line description">Loads macros and switches that unlock features.</td>
		</tr>
		<tr style="background-color: #dcfce7;">
			<td data-th="Section">Setup</td>
			<td data-th="Starts at"># ===== SETUP (green) =====</td>
			<td data-th="Ends at"># ===== STATEMENT (orange) =====</td>
			<td data-th="One-line description">Defines values, constraints, and answer objects.</td>
		</tr>
		<tr style="background-color: #ffedd5;">
			<td data-th="Section">Statement</td>
			<td data-th="Starts at"># ===== STATEMENT (orange) =====</td>
			<td data-th="Ends at"># ===== SOLUTION (pink) =====</td>
			<td data-th="One-line description">Contains the PGML prompt students read.</td>
		</tr>
		<tr style="background-color: #fce7f3;">
			<td data-th="Section">Solution</td>
			<td data-th="Starts at"># ===== SOLUTION (pink) =====</td>
			<td data-th="Ends at">ENDDOCUMENT();</td>
			<td data-th="One-line description">Explains the target and matches the grading rules.</td>
		</tr>
	</tbody>
</table>

<p>
<strong>Start edits in 4.2 to 4.5.</strong> This page is a reference copy so you can see the whole
file in one place after you make changes in the section-specific pages.
</p>

<h2>Section quick reference</h2>
<p style="background-color: #dbeafe; padding: 6px 10px;"><strong>Preamble (blue)</strong></p>
<p>
Why this exists: it declares the macros and global options that make the file render.
</p>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 50%;">
		<col style="width: 50%;">
	</colgroup>
	<thead>
		<tr>
			<th>Common edits</th>
			<th>Common failures</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Common edits">Add or remove a macro file.</td>
			<td data-th="Common failures">Missing macro that defines a feature.</td>
		</tr>
	</tbody>
</table>

<p style="background-color: #dcfce7; padding: 6px 10px;"><strong>Setup (green)</strong></p>
<p>
Why this exists: it defines the randomized values and the answer object.
</p>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 50%;">
		<col style="width: 50%;">
	</colgroup>
	<thead>
		<tr>
			<th>Common edits</th>
			<th>Common failures</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Common edits">Adjust ranges or tolerances.</td>
			<td data-th="Common failures">Impossible wet-lab values.</td>
		</tr>
	</tbody>
</table>

<p style="background-color: #ffedd5; padding: 6px 10px;"><strong>Statement (orange)</strong></p>
<p>
Why this exists: it is the PGML prompt with readable structure and blanks.
</p>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 50%;">
		<col style="width: 50%;">
	</colgroup>
	<thead>
		<tr>
			<th>Common edits</th>
			<th>Common failures</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Common edits">Rewrite the story or add a table.</td>
			<td data-th="Common failures">Blank not bound to an answer.</td>
		</tr>
	</tbody>
</table>

<p style="background-color: #fce7f3; padding: 6px 10px;"><strong>Solution (pink)</strong></p>
<p>
Why this exists: it explains the grading target and the method.
</p>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 50%;">
		<col style="width: 50%;">
	</colgroup>
	<thead>
		<tr>
			<th>Common edits</th>
			<th>Common failures</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Common edits">Clarify rounding or units.</td>
			<td data-th="Common failures">Solution mismatches the checker.</td>
		</tr>
	</tbody>
</table>

<h2>Complete file (reference copy)</h2>
<pre>
# ===== PREAMBLE (blue) =====
DOCUMENT();

loadMacros(
	"PGstandard.pl",
	"MathObjects.pl",
	"PGML.pl",
	"PGcourse.pl",
);

# ===== SETUP (green) =====
Context("Numeric");

$c_stock = random(5, 20, 5);     # uM (primer stock)
$v_stock = random(1, 5, 1);      # uL (pipetted primer volume)
$v_final = random(20, 50, 5);    # uL (final reaction volume)

$c_final = Real($c_stock * $v_stock / $v_final);
$c_final->cmp(tolType => "absolute", tol => 0.05);

# ===== STATEMENT (orange) =====
BEGIN_PGML
You are setting up a PCR reaction. You have a primer stock solution with concentration
[`c_{stock} = [$c_stock]`] &mu;M. You add [`V_{stock} = [$v_stock]`] &mu;L of the primer stock and
bring the total reaction volume to [`V_{final} = [$v_final]`] &mu;L.

What is the final primer concentration [`c_{final}`] in &mu;M?

[`c_{final} = `] [________]{$c_final} &mu;M
END_PGML

# ===== SOLUTION (pink) =====
BEGIN_PGML_SOLUTION
The final concentration uses a dilution calculation:

[`c_{final} = c_{stock} * V_{stock} / V_{final}`]

Substitute the values and report the result in &mu;M to match the checker.
END_PGML_SOLUTION

ENDDOCUMENT();
</pre>
