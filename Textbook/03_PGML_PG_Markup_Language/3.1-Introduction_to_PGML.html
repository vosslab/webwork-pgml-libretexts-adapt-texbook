<p>
PGML is a markup language for writing the student-facing text of a WeBWorK problem. It is designed
to replace older authoring styles that required long blocks of text and careful escaping.
</p>

<p>
In this book, <a href="/@go/page/488656">PG</a> is treated as minimal setup code, and PGML is where you spend most of your
authoring time.
</p>

<p>
<strong>Use this when:</strong> you want the prompt to read like a worksheet while keeping the
grading logic close to the text students see.
</p>

<h2>Copy and edit (minimum viable PGML)</h2>
<p>
This template shows a minimal PGML block with inline math, variable substitution, and one answer blank.
</p>
<pre>
$km = Real(2.5);
$substrate = Real(12);
$rate = Real(0.48);

BEGIN_PGML
For this enzyme, [`K_m = [$km]`] &mu;M and [`[S] = [$substrate]`] &mu;M.
Report the rate [`v`] in &mu;M/s:

[`v = `] [____]{$rate}
END_PGML
</pre>
<p>
Customize the variable names, the prompt text, and the answer expression in braces.
</p>

<p><strong>Common failure and fix</strong></p>
<p>
Without backtick delimiters, subscripts and Greek letters render as plain text instead of formatted math.
</p>
<pre>
Broken: Km = 2.5 &mu;M
Fix: [`K_m`] = 2.5 &mu;M
</pre>

<h2>What PGML is good at</h2>
<ul>
	<li>Readable prompts that look similar to the rendered output.</li>
	<li>Math written in TeX or calculator notation with consistent delimiters.</li>
	<li>Answer blanks tied directly to answer checkers.</li>
	<li>Structured formatting for science prompts (lists, tables, and short sections).</li>
</ul>

<p>
Most instructors do not need to learn PGML exhaustively. In practice, a small set of patterns
covers the majority of biology and life science questions: inline math, answer blanks, short
lists, and simple tables. This chapter focuses on those patterns so you can write readable prompts
without treating PGML as another programming language.
</p>

<h2>Math notation (TeX and calculator notation)</h2>
<p>
PGML supports two styles for writing mathematics: TeX and calculator notation. Both styles support
inline math and displayed math, and you should pick the one that matches the situation.
</p>
<p>
Use TeX when you care about typesetting (for example, <code>[`K_m`]</code> or
<code>[`V_{max}`]</code>). Use calculator notation when you care about readability and
copy-paste (for example, <code>[: Ct :]</code> or <code>[: C1*V1/V2 :]</code> for a dilution).
</p>

<h3>TeX math delimiters</h3>
<ul>
	<li>Inline: <code>[` ... `]</code></li>
	<li>Display-style inline: <code>[`` ... ``]</code></li>
	<li>Display (own line): <code>[``` ... ```]</code></li>
</ul>

<h3>Calculator notation delimiters</h3>
<ul>
	<li>Inline: <code>[: ... :]</code></li>
	<li>Display-style inline: <code>[:: ... ::]</code></li>
	<li>Display (own line): <code>[::: ... :::]</code></li>
</ul>

<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 30%;">
		<col style="width: 24%;">
		<col style="width: 46%;">
	</colgroup>
	<thead>
		<tr>
			<th>Task</th>
			<th>Delimiter</th>
			<th>Example</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Task">Variable name</td>
			<td data-th="Delimiter">TeX inline</td>
			<td data-th="Example"><code>[`K_m`]</code></td>
		</tr>
		<tr>
			<td data-th="Task">Short equation</td>
			<td data-th="Delimiter">Calculator inline</td>
			<td data-th="Example"><code>[: C1*V1/V2 :]</code></td>
		</tr>
		<tr>
			<td data-th="Task">Long equation</td>
			<td data-th="Delimiter">TeX display</td>
			<td data-th="Example"><code>[``` V = V_{max} * S/(K_m + S) ```]</code></td>
		</tr>
	</tbody>
</table>

<h3>Science-friendly practice</h3>
<ul>
	<li>Use inline math for variable names and short expressions.</li>
	<li>Use display math for longer equations or multi-step expressions.</li>
	<li>Keep units outside the math expression unless you are explicitly typesetting them.</li>
</ul>

<h2>Math formatting vs variable substitution</h2>
<p>
PGML uses square brackets for two different purposes. Confusing them is a common mistake.
</p>
<table class="mt-responsive-table">
	<colgroup>
		<col style="width: 22%;">
		<col style="width: 26%;">
		<col style="width: 26%;">
		<col style="width: 26%;">
	</colgroup>
	<thead>
		<tr>
			<th>Purpose</th>
			<th>Syntax</th>
			<th>Example</th>
			<th>Result</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td data-th="Purpose">Math formatting</td>
			<td data-th="Syntax"><code>[` ... `]</code></td>
			<td data-th="Example"><code>[`K_m`]</code></td>
			<td data-th="Result">Renders K with subscript m</td>
		</tr>
		<tr>
			<td data-th="Purpose">Variable substitution</td>
			<td data-th="Syntax"><code>[$variable]</code></td>
			<td data-th="Example"><code>[$km]</code></td>
			<td data-th="Result">Displays value: 2.5</td>
		</tr>
		<tr>
			<td data-th="Purpose">Combined</td>
			<td data-th="Syntax"><code>[`K_m = [$km]`]</code></td>
			<td data-th="Example"><code>[`K_m = [$km]`]</code></td>
			<td data-th="Result">Math with value inserted</td>
		</tr>
	</tbody>
</table>
<p>
<strong>Key rule:</strong> Use backticks when you want LaTeX math rendering. Use plain brackets
(no backticks) when you want to display a variable's value as text.
</p>
<p><strong>Common mistake</strong></p>
<pre>
Wrong: The answer is [`$radio->correct_ans`]
Right: The answer is [$radio->correct_ans]
</pre>
<p>
The wrong version tries to render "Blue" as LaTeX math. The right version displays the text value.
</p>

<h2>PGML is single-pass</h2>
<p>
PGML parses your text exactly once. This means that if you build PGML tag-wrapper syntax inside a
Perl variable, PGML will not re-parse it. The variable's contents are inserted as literal text, so
patterns like <code>[&lt;...&gt;]{[...]}</code> stored in a string will not produce the expected
formatting.
</p>

<p>
A related pitfall involves the <code>[&lt;</code> character sequence. If a Perl string assigned
earlier in your code contains <code>[&lt;</code>, it can collide with PGML's own bracket-angle
syntax and produce parser errors or garbled output. Watch for this when building HTML snippets or
conditional text in Perl and then inserting them with <code>[$var]</code>.
</p>

<p>
The single-pass rule also means that <code>[$...]</code> PGML interpolation inside a
<code>[@ ... @]</code> eval block will not work. The eval block runs Perl; it does not re-enter
the PGML parser. If you need formatted output from an eval block, return a string and let PGML
display it.
</p>

<p>
If you are writing your first problem, go to <a href="/@go/page/555704">Section 3.2</a> now.
</p>

<p><strong>Next, depending on what you are doing:</strong></p>
<ul>
	<li>Need a blank that grades correctly? See <a href="/@go/page/555704">Section 3.2</a>.</li>
	<li>Building a multi-step workflow prompt? See <a href="/@go/page/555705">Section 3.3</a>.</li>
	<li>Need a data table students read from? See <a href="/@go/page/555706">Section 3.4</a>.</li>
</ul>
